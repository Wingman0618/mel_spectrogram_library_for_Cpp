## Introduction
This library is orginally designed for keyword spotting in deployment process of the tiny machine learning. 
It is also allowed to be a common mel spectrogram generator library. 
However, due to the embedded usage, there are some of limitations in data type.

The library contains functions fundamentally computing discrete fourier transform (DFT) by implementing fast fourier transform (FFT),
mel scale transfrom, and power or amplitude converter to decibel (db).
## Import the library
1. Put the dft.h and dft.cpp into the project directory. 
1. Then include the dft header file. \
   e.g: #include "dft.h" or #include ".../dft.h"
1. Include the dft.cpp in compiling process. \
   e.g: g++ -o main main.cpp dft.cpp
## Functions implementation
The main.cpp contains the examples of implementing the functions by computing the sin wave and a "yes" audio. The test.ipynb jupyter notebook
has a traslation function in python and comparing the output result with those generated by numpy, tensorflow and librosa.
### *dft()*
This founction takes the data of signal in double type and the length of the signal (the number of data in the single signal)
as input parameters. Returning a complex double type array. \
![Function declaration dft()](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/8f843f96-41e5-4cf5-a42f-dd672792a7c9) \
Calling the function, where the y_output is the result of a sinwave form 0 to 15. \
![Function call dft()](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/d063d510-673e-4e1a-9e7b-e2af2495f5fa) \
It can be computed to the absolute values simply by the abs() function. \
![Output by abs()](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/b48484ea-b475-48fc-ba8e-dbae987d70ca) \
![Output results by abs()](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/a1e758ce-bd3b-4a27-84ef-979d5d15c1a6)
### *dft_rfft()*
This function takes the same inpus as dft() but only return first half plus 1 results of the fourier transform.
This function is typically used in shot-time fourier transform. When input data is real number, the output result would be symmetry.
Therefore, only half result needed.\
![Shot-time fourier transform by tensorflow.signal.stft](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/7d1dfd59-ea4e-4a46-8b00-6e1c5c671536) \
*Real number inputs shot-time fourier transform by tensorflow.signal.stft* \
![Screenshot from 2024-05-27 12-36-29](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/a737ed3a-f63b-4b1d-b1ad-ef92410af9f8) \
*Full results of the shot-time fourier transform*
### *hamming() and hamming_data*
The functions performs the hamming window. *hamming()* take the number of inputs and compute the hamming result.
*hamming_data()* take the signal data and the number of data, returning the result after implementing hamming window on input signal data. \
![hamming window](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/9bf93177-1d9f-49e5-8cc2-f70306533832)
### *stft()*
This function is used to compute the short-time fourier transfrom, taking input signal data, the number of the signal data, window size (or n_ffts), and hop_length. \
![stft()](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/dc8b6d5b-7878-4c8a-813f-f4f6ef9f18fc) \
The test result (test input: 15872 length of the "yes" audio) after converting its amplitude to db. (Plotted in jupyterlab) \
![test result](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/41d5f388-2cfa-4651-bf58-7be0f65b0795) \
It is almost the same as that plotted by tensorflow.signal.stft.

P.S: Due to the embedded usage, the function only was tested by 15872 input singal data with 512 window size and 256 hop_length. 
For futher usage, extra tests may be required as there is not any padding functions and input checking functions in this library.
### *mel_spec()*
This function generates the mel scale values of the *short-time fourier transform* of the input signal data.

Due to the embedded usage, the lower and upper frequency was defined as 300hz and 8000hz, which can be modified in dft.cpp. \
![the lower and upper frequency](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/3168e42d-eb1c-48a9-990b-cf91a2c5c107)
### *power_to_db* and *amplitude_to_db*
These two functions convert the power of amplitude to decibel (db). \
![*power_to_db* and *amplitude_to_db*](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/e36b288f-010c-4c31-a1f8-563c21d07aac) \
Due to the embedded usage, the functions were based on the implementation of the librosa with top_db in 80 and 
the max value in the array as reference value. \
The implementation test on jupyter lab. \
![amplitude_to_db](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/594fccba-cd6b-46af-ba21-bce380410dbf) \
Amplitude to db spectrogram plotted by librosa.display.specshow()\
![power_to_db](https://github.com/Wingman0618/mel_spectrogram_library_for_Cpp/assets/111321164/078511b1-513a-4d41-baef-c25968e5768d) \
Power to db spectrogram plotted by librosa.display.specshow()
## Reference
### *Fourier transform*
Discrete fourier transform: https://www.youtube.com/watch?v=nl9TZanwbBk \
Fast fourier transform: https://www.youtube.com/watch?v=Xw4voABxU5c
### *Mel spectrogram generator*
http://practicalcryptography.com/miscellaneous/machine-learning/guide-mel-frequency-cepstral-coefficients-mfccs/ \
https://haythamfayek.com/2016/04/21/speech-processing-for-machine-learning.html
### *Coding reference*
hamming: https://numpy.org/doc/stable/reference/generated/numpy.hamming.html \
stft: https://www.tensorflow.org/api_docs/python/tf/signal/stft \
power_to_db: https://librosa.org/doc/main/generated/librosa.power_to_db.html \
amplitude_to_db: https://librosa.org/doc/main/generated/librosa.amplitude_to_db.html \
